#!/bin/dash

url="$1"
id=$(xdotool search --name "Tor Browser" 2> /dev/null)

if [ -z "$id" ]; then
  torbrowser-launcher "$url"
else
  sleep 0.1 # needed when triggering the script from newsboat, will not open tab otherwise
  xdotool windowactivate $id
  xdotool key --window $id --clearmodifiers Ctrl+t
  xdotool key --window $id --clearmodifiers Ctrl+L
  xdotool type --window $id "$url"
  xdotool key --window $id --clearmodifiers Return
fi

#!/bin/bash

BOOKMARKS_PATH="${XDG_CONFIG_HOME:-HOME/.config}/bookmarks.txt"

main () {
	choice=$(echo -e "Open\nAdd" | dmenu -p "Bookmarks menu:")

	case "$choice" in
		Open) open;;
		Add) add;;
	esac
}

open () {
	url=$(awk 'BEGIN { FS = "|" } ; {print $2"\t"$1}' "$BOOKMARKS_PATH" \
			| column -t -s $'\t' \
			| dmenu -l 15 -p "Open bookmark: " \
			| awk '{print $NF}')

	[ -z "$url" ] && exit

	torbrowser "$url"
}

add () {
	eval "scratchpad nvim $BOOKMARKS_PATH" >> /dev/null
}

main $@

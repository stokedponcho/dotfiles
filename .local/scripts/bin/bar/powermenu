#!/bin/bash

# Custom rofi script to prompt system menu
# Credits to and inspiration from https://github.com/piratecaveman/dotfiles/blob/master/home/wraith/.config/polybar/scripts/sysmenu
# TODO: improvements using https://github.com/adi1090x/rofi

dir="$(dirname $0)"

#confirm_exit() {
  #echo -e "Yes\nNo" \
    #| rofi -theme "$dir/confirm.rasi" \
        #-no-fixed-num-lines \
        #-dmenu -i -p "Are You Sure?"
#}

lock=""
signout=""
reboot=""
shutdown=""
uptime=$(uptime -p | sed -e 's/up //g')
options="$lock\n$signout\n$reboot\n$shutdown"
choice=$(echo -e "$options" \
          | rofi \
              -theme "$dir/powermenu.rasi" \
              -no-lazy-grab \
              -dmenu -i -p "Uptime: $uptime" - selected-row 2)

[[ -z "$choice" ]] && exit

#confirmation=$(confirm_exit)
#[[ "$confirmation" != "Yes" ]] && exit

case "$choice" in
  $lock) slock ;;
  $signout) bspc quit && sh -c 'exit' ;;
  $reboot) systemctl reboot ;;
  $shutdown) systemctl poweroff ;;
esac
